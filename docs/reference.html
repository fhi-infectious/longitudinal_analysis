<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Longitudinal Analysis</title>
  <meta name="description" content="A short course in learning which statistical methods should be applied where.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Longitudinal Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A short course in learning which statistical methods should be applied where." />
  <meta name="github-repo" content="raubreywhite/longitudinal_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Longitudinal Analysis" />
  
  <meta name="twitter:description" content="A short course in learning which statistical methods should be applied where." />
  

<meta name="author" content="Richard White">


<meta name="date" content="2018-05-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="panel-data-one-area-without-autocorrelation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="/">Home</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a></li>
<li class="chapter" data-level="2" data-path="reference.html"><a href="reference.html"><i class="fa fa-check"></i><b>2</b> Reference</a><ul>
<li class="chapter" data-level="2.1" data-path="reference.html"><a href="reference.html#scope-of-this-course"><i class="fa fa-check"></i><b>2.1</b> Scope of this course</a></li>
<li class="chapter" data-level="2.2" data-path="reference.html"><a href="reference.html#introduction"><i class="fa fa-check"></i><b>2.2</b> Introduction</a></li>
<li class="chapter" data-level="2.3" data-path="reference.html"><a href="reference.html#method-summary"><i class="fa fa-check"></i><b>2.3</b> Method summary</a><ul>
<li class="chapter" data-level="2.3.1" data-path="reference.html"><a href="reference.html#panel-data-one-geographical-area-no-autocorrelation"><i class="fa fa-check"></i><b>2.3.1</b> Panel data: One geographical area, no autocorrelation</a></li>
<li class="chapter" data-level="2.3.2" data-path="reference.html"><a href="reference.html#panel-data-one-geographical-area-with-autocorrelation"><i class="fa fa-check"></i><b>2.3.2</b> Panel data: One geographical area, with autocorrelation</a></li>
<li class="chapter" data-level="2.3.3" data-path="reference.html"><a href="reference.html#not-panel-data-multiple-geographical-areas"><i class="fa fa-check"></i><b>2.3.3</b> Not panel data: Multiple geographical areas</a></li>
<li class="chapter" data-level="2.3.4" data-path="reference.html"><a href="reference.html#panel-data-multiple-geographical-areas-no-autocorrelation"><i class="fa fa-check"></i><b>2.3.4</b> Panel data: Multiple geographical areas, no autocorrelation</a></li>
<li class="chapter" data-level="2.3.5" data-path="reference.html"><a href="reference.html#panel-data-multiple-geographical-areas-with-autocorrelation"><i class="fa fa-check"></i><b>2.3.5</b> Panel data: Multiple geographical areas, with autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="reference.html"><a href="reference.html#identifying-your-scenario"><i class="fa fa-check"></i><b>2.4</b> Identifying your scenario</a><ul>
<li class="chapter" data-level="2.4.1" data-path="reference.html"><a href="reference.html#step-1-do-you-have-panel-data"><i class="fa fa-check"></i><b>2.4.1</b> Step 1: Do you have panel data?</a></li>
<li class="chapter" data-level="2.4.2" data-path="reference.html"><a href="reference.html#step-2-do-you-have-multiple-geographical-areas"><i class="fa fa-check"></i><b>2.4.2</b> Step 2: Do you have multiple geographical areas?</a></li>
<li class="chapter" data-level="2.4.3" data-path="reference.html"><a href="reference.html#step-3-do-you-have-autocorrelation"><i class="fa fa-check"></i><b>2.4.3</b> Step 3: Do you have autocorrelation?</a></li>
<li class="chapter" data-level="2.4.4" data-path="reference.html"><a href="reference.html#ar1-data"><i class="fa fa-check"></i><b>2.4.4</b> AR(1) data</a></li>
<li class="chapter" data-level="2.4.5" data-path="reference.html"><a href="reference.html#ar2-data"><i class="fa fa-check"></i><b>2.4.5</b> AR(2) data</a></li>
<li class="chapter" data-level="2.4.6" data-path="reference.html"><a href="reference.html#ma1-data"><i class="fa fa-check"></i><b>2.4.6</b> MA(1) data</a></li>
<li class="chapter" data-level="2.4.7" data-path="reference.html"><a href="reference.html#ma2-data"><i class="fa fa-check"></i><b>2.4.7</b> MA(2) data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="panel-data-one-area-without-autocorrelation.html"><a href="panel-data-one-area-without-autocorrelation.html"><i class="fa fa-check"></i><b>3</b> Panel data: One area without autocorrelation</a><ul>
<li class="chapter" data-level="3.1" data-path="panel-data-one-area-without-autocorrelation.html"><a href="panel-data-one-area-without-autocorrelation.html#aim"><i class="fa fa-check"></i><b>3.1</b> Aim</a></li>
<li class="chapter" data-level="3.2" data-path="panel-data-one-area-without-autocorrelation.html"><a href="panel-data-one-area-without-autocorrelation.html#creating-the-data"><i class="fa fa-check"></i><b>3.2</b> Creating the data</a></li>
<li class="chapter" data-level="3.3" data-path="panel-data-one-area-without-autocorrelation.html"><a href="panel-data-one-area-without-autocorrelation.html#true-data"><i class="fa fa-check"></i><b>3.3</b> True data</a></li>
<li class="chapter" data-level="3.4" data-path="panel-data-one-area-without-autocorrelation.html"><a href="panel-data-one-area-without-autocorrelation.html#investigation"><i class="fa fa-check"></i><b>3.4</b> Investigation</a></li>
<li class="chapter" data-level="3.5" data-path="panel-data-one-area-without-autocorrelation.html"><a href="panel-data-one-area-without-autocorrelation.html#seasonality"><i class="fa fa-check"></i><b>3.5</b> Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="panel-data-one-area-with-autocorrelation.html"><a href="panel-data-one-area-with-autocorrelation.html"><i class="fa fa-check"></i><b>4</b> Panel data: One area with autocorrelation</a><ul>
<li class="chapter" data-level="4.1" data-path="panel-data-one-area-with-autocorrelation.html"><a href="panel-data-one-area-with-autocorrelation.html#aim-1"><i class="fa fa-check"></i><b>4.1</b> Aim</a></li>
<li class="chapter" data-level="4.2" data-path="panel-data-one-area-with-autocorrelation.html"><a href="panel-data-one-area-with-autocorrelation.html#creating-the-data-1"><i class="fa fa-check"></i><b>4.2</b> Creating the data</a></li>
<li class="chapter" data-level="4.3" data-path="panel-data-one-area-with-autocorrelation.html"><a href="panel-data-one-area-with-autocorrelation.html#investigation-1"><i class="fa fa-check"></i><b>4.3</b> Investigation</a></li>
<li class="chapter" data-level="4.4" data-path="panel-data-one-area-with-autocorrelation.html"><a href="panel-data-one-area-with-autocorrelation.html#regressions"><i class="fa fa-check"></i><b>4.4</b> Regressions</a></li>
<li class="chapter" data-level="4.5" data-path="panel-data-one-area-with-autocorrelation.html"><a href="panel-data-one-area-with-autocorrelation.html#residual-analysis"><i class="fa fa-check"></i><b>4.5</b> Residual analysis</a></li>
<li class="chapter" data-level="4.6" data-path="panel-data-one-area-with-autocorrelation.html"><a href="panel-data-one-area-with-autocorrelation.html#r-only-regression-with-ar1-correlation-in-residuals"><i class="fa fa-check"></i><b>4.6</b> (R ONLY) Regression with AR(1) correlation in residuals</a></li>
<li class="chapter" data-level="4.7" data-path="panel-data-one-area-with-autocorrelation.html"><a href="panel-data-one-area-with-autocorrelation.html#stata-only-regression-with-robust-standard-errors"><i class="fa fa-check"></i><b>4.7</b> (STATA ONLY) Regression with robust standard errors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="not-panel-data-multiple-areas.html"><a href="not-panel-data-multiple-areas.html"><i class="fa fa-check"></i><b>5</b> Not panel data: Multiple areas</a><ul>
<li class="chapter" data-level="5.1" data-path="not-panel-data-multiple-areas.html"><a href="not-panel-data-multiple-areas.html#aim-2"><i class="fa fa-check"></i><b>5.1</b> Aim</a></li>
<li class="chapter" data-level="5.2" data-path="not-panel-data-multiple-areas.html"><a href="not-panel-data-multiple-areas.html#creating-the-data-2"><i class="fa fa-check"></i><b>5.2</b> Creating the data</a></li>
<li class="chapter" data-level="5.3" data-path="not-panel-data-multiple-areas.html"><a href="not-panel-data-multiple-areas.html#investigating-the-data"><i class="fa fa-check"></i><b>5.3</b> Investigating the data</a></li>
<li class="chapter" data-level="5.4" data-path="not-panel-data-multiple-areas.html"><a href="not-panel-data-multiple-areas.html#regression"><i class="fa fa-check"></i><b>5.4</b> Regression</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="panel-data-multiple-areas-without-autocorrelation.html"><a href="panel-data-multiple-areas-without-autocorrelation.html"><i class="fa fa-check"></i><b>6</b> Panel data: multiple areas without autocorrelation</a><ul>
<li class="chapter" data-level="6.1" data-path="panel-data-multiple-areas-without-autocorrelation.html"><a href="panel-data-multiple-areas-without-autocorrelation.html#aim-3"><i class="fa fa-check"></i><b>6.1</b> Aim</a></li>
<li class="chapter" data-level="6.2" data-path="panel-data-multiple-areas-without-autocorrelation.html"><a href="panel-data-multiple-areas-without-autocorrelation.html#creating-the-data-3"><i class="fa fa-check"></i><b>6.2</b> Creating the data</a></li>
<li class="chapter" data-level="6.3" data-path="panel-data-multiple-areas-without-autocorrelation.html"><a href="panel-data-multiple-areas-without-autocorrelation.html#investigation-2"><i class="fa fa-check"></i><b>6.3</b> Investigation</a></li>
<li class="chapter" data-level="6.4" data-path="panel-data-multiple-areas-without-autocorrelation.html"><a href="panel-data-multiple-areas-without-autocorrelation.html#regression-1"><i class="fa fa-check"></i><b>6.4</b> Regression</a></li>
<li class="chapter" data-level="6.5" data-path="panel-data-multiple-areas-without-autocorrelation.html"><a href="panel-data-multiple-areas-without-autocorrelation.html#residual-analysis-1"><i class="fa fa-check"></i><b>6.5</b> Residual analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="panel-data-multiple-areas-with-autocorrelation.html"><a href="panel-data-multiple-areas-with-autocorrelation.html"><i class="fa fa-check"></i><b>7</b> Panel data: multiple areas with autocorrelation</a><ul>
<li class="chapter" data-level="7.1" data-path="panel-data-multiple-areas-with-autocorrelation.html"><a href="panel-data-multiple-areas-with-autocorrelation.html#aim-4"><i class="fa fa-check"></i><b>7.1</b> Aim</a></li>
<li class="chapter" data-level="7.2" data-path="panel-data-multiple-areas-with-autocorrelation.html"><a href="panel-data-multiple-areas-with-autocorrelation.html#creating-the-data-4"><i class="fa fa-check"></i><b>7.2</b> Creating the data</a></li>
<li class="chapter" data-level="7.3" data-path="panel-data-multiple-areas-with-autocorrelation.html"><a href="panel-data-multiple-areas-with-autocorrelation.html#investigation-3"><i class="fa fa-check"></i><b>7.3</b> Investigation</a></li>
<li class="chapter" data-level="7.4" data-path="panel-data-multiple-areas-with-autocorrelation.html"><a href="panel-data-multiple-areas-with-autocorrelation.html#regressions-1"><i class="fa fa-check"></i><b>7.4</b> Regressions</a></li>
<li class="chapter" data-level="7.5" data-path="panel-data-multiple-areas-with-autocorrelation.html"><a href="panel-data-multiple-areas-with-autocorrelation.html#residual-analysis-2"><i class="fa fa-check"></i><b>7.5</b> Residual analysis</a></li>
<li class="chapter" data-level="7.6" data-path="panel-data-multiple-areas-with-autocorrelation.html"><a href="panel-data-multiple-areas-with-autocorrelation.html#r-only-regression-with-ar1-correlation-in-residuals-1"><i class="fa fa-check"></i><b>7.6</b> (R ONLY) Regression with AR(1) correlation in residuals</a></li>
<li class="chapter" data-level="7.7" data-path="panel-data-multiple-areas-with-autocorrelation.html"><a href="panel-data-multiple-areas-with-autocorrelation.html#residual-analysis-3"><i class="fa fa-check"></i><b>7.7</b> Residual analysis</a></li>
<li class="chapter" data-level="7.8" data-path="panel-data-multiple-areas-with-autocorrelation.html"><a href="panel-data-multiple-areas-with-autocorrelation.html#stata-only-regression-with-robust-standard-errors-1"><i class="fa fa-check"></i><b>7.8</b> (STATA ONLY) Regression with robust standard errors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>8</b> Exercises</a><ul>
<li class="chapter" data-level="8.1" data-path="exercises.html"><a href="exercises.html#exercise-1"><i class="fa fa-check"></i><b>8.1</b> Exercise 1</a></li>
<li class="chapter" data-level="8.2" data-path="exercises.html"><a href="exercises.html#exercise-2"><i class="fa fa-check"></i><b>8.2</b> Exercise 2</a></li>
<li class="chapter" data-level="8.3" data-path="exercises.html"><a href="exercises.html#exercise-3"><i class="fa fa-check"></i><b>8.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>9</b> Solutions</a><ul>
<li class="chapter" data-level="9.1" data-path="solutions.html"><a href="solutions.html#exercise-1-1"><i class="fa fa-check"></i><b>9.1</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="solutions-1.html"><a href="solutions-1.html"><i class="fa fa-check"></i><b>10</b> Solutions</a><ul>
<li class="chapter" data-level="10.1" data-path="solutions-1.html"><a href="solutions-1.html#exercise-2-1"><i class="fa fa-check"></i><b>10.1</b> Exercise 2</a></li>
<li class="chapter" data-level="10.2" data-path="solutions-1.html"><a href="solutions-1.html#exercise-3-1"><i class="fa fa-check"></i><b>10.2</b> Exercise 3</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Longitudinal Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reference" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Reference</h1>
<div id="scope-of-this-course" class="section level2">
<h2><span class="header-section-number">2.1</span> Scope of this course</h2>
<p>When dealing with longitudinal data, there are two kinds of analyses that can be performed.</p>
<p>“Time series” analyses generally deal with one variable. The aim is to then predict the future only using the previous observations. A common example would be to predict tomorrow’s temperature, using today’s and yesterday’s temperature as exposures. We will not be focusing on these kinds of analyses in this course.</p>
<p>“Regression analyses” are very similar to ordinary regressions that you have been working with for many years. The only difference is that they have more advanced data structures that your current methods cannot handle. For example, if you want to see how the number of tuberculosis patients (outcome) is affected by the number of immigrants to Norway (exposure) over a 20 year period, then the number of patients in each year might be associated with each other, which might break assumptions of the regression models that you normally use (independent residuals). To account for the advanced structure of the data (correlation between different years) we will use more advanced regression techniques. This is what we will be focusing on in this course.</p>
<p>To recap: this course will let you run “normal regressions” in situations where the data structure would ordinarily prohibit you from running regression models. These situations mostly pertain to clusters of correlated data.</p>

</div>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">2.2</span> Introduction</h2>
<p>There are two important definitions in this course:</p>
<ul>
<li>Panel data</li>
<li>Autocorrelation</li>
</ul>
<p>Panel data is a set of data with measurements repeated at equally spaced points. For example, weight data recorded every day, or every week, or every year would be considered panel data. A person who records three weight measurements randomly in 2018 would not be considered panel data.</p>
<p>When you have panel data, autocorrelation is the correlation between subsequent observations. For example, if you have daily observations, then the 1 day autocorrelation is the correlation between observations 1 day apart, and likewise the 2 day autocorrelation is the correlation between observations 2 days apart.</p>
<p>In this course we will consider 5 scenarios where we have multiple observations for each geographical area:</p>
<ul>
<li>Panel data: One geographical area, no autocorrelation</li>
<li>Panel data: One geographical area, with autocorrelation</li>
<li>Not panel data: Multiple geographical areas</li>
<li>Panel data: Multiple geographical areas, no autocorrelation</li>
<li>Panel data: Multiple geographical areas, with autocorrelation</li>
</ul>
<p>Note, the following scenario can be covered by standard regression models:</p>
<ul>
<li>Multiple geographical areas, one time point/observation per geographical area</li>
</ul>

</div>
<div id="method-summary" class="section level2">
<h2><span class="header-section-number">2.3</span> Method summary</h2>
<div id="panel-data-one-geographical-area-no-autocorrelation" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Panel data: One geographical area, no autocorrelation</h3>
<pre><code>// STATA CODE
glm y yearminus2000 dailyrainfall cos365 sin365, family(poisson)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># R CODE</span>
fit1 &lt;-<span class="st"> </span><span class="kw">glm</span>(y<span class="op">~</span>yearMinus2000 <span class="op">+</span><span class="st"> </span>dailyrainfall <span class="op">+</span><span class="st"> </span>sin365 <span class="op">+</span><span class="st"> </span>cos365, <span class="dt">data=</span>d, <span class="dt">family=</span><span class="kw">poisson</span>())
<span class="kw">residuals</span>(fit1, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</code></pre></div>
</div>
<div id="panel-data-one-geographical-area-with-autocorrelation" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Panel data: One geographical area, with autocorrelation</h3>
<pre><code>// STATA CODE
glm y yearminus2000 cos365 sin365, family(poisson) vce(robust)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># R CODE</span>
fit &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(y<span class="op">~</span>yearMinus2000<span class="op">+</span>sin365 <span class="op">+</span><span class="st"> </span>cos365, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID,
                <span class="dt">family =</span> poisson, <span class="dt">data =</span> d,
                <span class="dt">correlation=</span>nlme<span class="op">::</span><span class="kw">corAR1</span>(<span class="dt">form=</span><span class="op">~</span>dayOfSeries<span class="op">|</span>ID))
r &lt;-<span class="st"> </span><span class="kw">residuals</span>(fit1, <span class="dt">type =</span> <span class="st">&quot;normalized&quot;</span>)
<span class="kw">pacf</span>(r)</code></pre></div>
</div>
<div id="not-panel-data-multiple-geographical-areas" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Not panel data: Multiple geographical areas</h3>
<pre><code>// STATA CODE
meglm y x yearMinus2000 || fylke:, family(poisson)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># R CODE</span>
fit &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">glmer</span>(y<span class="op">~</span>x <span class="op">+</span><span class="st"> </span>yearMinus2000 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>fylke),<span class="dt">data=</span>d,<span class="dt">family=</span><span class="kw">poisson</span>())</code></pre></div>
</div>
<div id="panel-data-multiple-geographical-areas-no-autocorrelation" class="section level3">
<h3><span class="header-section-number">2.3.4</span> Panel data: Multiple geographical areas, no autocorrelation</h3>
<pre><code>// STATA CODE
meglm y yearminus2000 cos365 sin365 || fylke:, family(poisson)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># R CODE</span>
fit &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(y<span class="op">~</span>yearMinus2000<span class="op">+</span>sin365 <span class="op">+</span><span class="st"> </span>cos365, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>fylke,
                <span class="dt">family =</span> poisson, <span class="dt">data =</span> d)
r &lt;-<span class="st"> </span><span class="kw">residuals</span>(fit1, <span class="dt">type =</span> <span class="st">&quot;normalized&quot;</span>)
<span class="kw">pacf</span>(r)</code></pre></div>
</div>
<div id="panel-data-multiple-geographical-areas-with-autocorrelation" class="section level3">
<h3><span class="header-section-number">2.3.5</span> Panel data: Multiple geographical areas, with autocorrelation</h3>
<pre><code>// STATA CODE
meglm y yearminus2000 cos365 sin365 || fylke:, family(poisson) vce(robust)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># R CODE</span>
fit &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">glmmPQL</span>(y<span class="op">~</span>yearMinus2000<span class="op">+</span>sin365 <span class="op">+</span><span class="st"> </span>cos365, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>fylke,
                <span class="dt">family =</span> poisson, <span class="dt">data =</span> d,
                <span class="dt">correlation=</span>nlme<span class="op">::</span><span class="kw">corAR1</span>(<span class="dt">form=</span><span class="op">~</span>dayOfSeries<span class="op">|</span>fylke))
r &lt;-<span class="st"> </span><span class="kw">residuals</span>(fit1, <span class="dt">type =</span> <span class="st">&quot;normalized&quot;</span>)
<span class="kw">pacf</span>(r)</code></pre></div>

</div>
</div>
<div id="identifying-your-scenario" class="section level2">
<h2><span class="header-section-number">2.4</span> Identifying your scenario</h2>
<div id="step-1-do-you-have-panel-data" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Step 1: Do you have panel data?</h3>
<p>This step should be fairly simple. If your data has equally spaced time intervals between them, you have panel data.</p>
</div>
<div id="step-2-do-you-have-multiple-geographical-areas" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Step 2: Do you have multiple geographical areas?</h3>
<p>Again, fairly simple, just look at your data.</p>
</div>
<div id="step-3-do-you-have-autocorrelation" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Step 3: Do you have autocorrelation?</h3>
<p>Firstly, you must run a model pretending that you do not have autocorrelation.</p>
<p>You then inspect the residuals from the model and see if autocorrelation exists. This is done with two statistical procedures: <code>pacf</code> (for <code>autoregressive models</code>, the most common type of autocorrelation), and <code>acf</code> (for <code>moving average models</code>, a less common type of autocorrelation).</p>

</div>
<div id="ar1-data" class="section level3">
<h3><span class="header-section-number">2.4.4</span> AR(1) data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">as.numeric</span>(<span class="kw">arima.sim</span>(<span class="dt">model=</span><span class="kw">list</span>(<span class="st">&quot;ar&quot;</span>=<span class="kw">c</span>(<span class="fl">0.5</span>)), <span class="dt">rand.gen =</span> rnorm, <span class="dt">n=</span><span class="dv">1000</span>)))</code></pre></div>
<p>With <code>autoregressive</code> data, a <code>pacf</code> plot contains a number of sharp significant lines, indicating how many subsequent observations have autocorrelation. i.e. if one line is significant, it means that each observation is only correlated with its preceeding observation (<code>AR(1)</code>). If two lines are significant, it means that each observation is correlated with its two preceeding observations (<code>AR(2)</code>). The following plot represents <code>AR(1)</code> data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pacf</span>(y)</code></pre></div>
<p><img src="longitudinal-analysis_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>

<p>With <code>autoregressive</code> data, an <code>acf</code> plot contains a number of decreasing lines. The following <code>acf</code> plot represents some sort of <code>AR</code> data. Note that the <code>acf</code> plot displays <code>lag 0</code> (which is pointless and can be ignored), while the <code>pacf</code> plot does not.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">acf</span>(y)</code></pre></div>
<p><img src="longitudinal-analysis_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>

</div>
<div id="ar2-data" class="section level3">
<h3><span class="header-section-number">2.4.5</span> AR(2) data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">as.numeric</span>(<span class="kw">arima.sim</span>(<span class="dt">model=</span><span class="kw">list</span>(<span class="st">&quot;ar&quot;</span>=<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.4</span>)), <span class="dt">rand.gen =</span> rnorm, <span class="dt">n=</span><span class="dv">1000</span>)))</code></pre></div>
<p>The following <code>pacf</code> plot represents <code>AR(2)</code> data. This means that each observation is correlated with its two preceeding observations (<code>AR(2)</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pacf</span>(y)</code></pre></div>
<p><img src="longitudinal-analysis_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>

<p>The following <code>acf</code> plot represents some sort of <code>AR</code> data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">acf</span>(y)</code></pre></div>
<p><img src="longitudinal-analysis_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>

</div>
<div id="ma1-data" class="section level3">
<h3><span class="header-section-number">2.4.6</span> MA(1) data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">as.numeric</span>(<span class="kw">arima.sim</span>(<span class="dt">model=</span><span class="kw">list</span>(<span class="st">&quot;ma&quot;</span>=<span class="kw">c</span>(<span class="fl">0.9</span>)), <span class="dt">rand.gen =</span> rnorm, <span class="dt">n=</span><span class="dv">1000</span>)))</code></pre></div>
<p>With <code>moving average</code> data, a <code>pacf</code> plot contains a number of decreasing lines. The following <code>pacf</code> plot represents some sort of <code>MA</code> data.:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pacf</span>(y)</code></pre></div>
<p><img src="longitudinal-analysis_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>

<p>With <code>moving average</code> data, an <code>acf</code> plot contains a number of sharp significant lines, demarking how many subsequent observations have autocorrelation. i.e. if one line is significant, it means that each observation is only correlated with its preceeding observation. If two lines are significant, it means that each observation is correlated with its two preceeding observations. The following plot represents <code>MA(1)</code> data. Note that the <code>acf</code> plot displays <code>lag 0</code> (which is pointless and can be ignored), while the <code>pacf</code> plot does not.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">acf</span>(y)</code></pre></div>
<p><img src="longitudinal-analysis_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>

</div>
<div id="ma2-data" class="section level3">
<h3><span class="header-section-number">2.4.7</span> MA(2) data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">as.numeric</span>(<span class="kw">arima.sim</span>(<span class="dt">model=</span><span class="kw">list</span>(<span class="st">&quot;ma&quot;</span>=<span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.6</span>)), <span class="dt">rand.gen =</span> rnorm, <span class="dt">n=</span><span class="dv">1000</span>)))</code></pre></div>
<p>The following <code>pacf</code> plot represents some sort of <code>MA</code> data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pacf</span>(y)</code></pre></div>
<p><img src="longitudinal-analysis_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>

<p>The following <code>acf</code> plot represents <code>MA(2)</code> data. This means that each observation is correlated with its two preceeding observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">acf</span>(y)</code></pre></div>
<p><img src="longitudinal-analysis_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="panel-data-one-area-without-autocorrelation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/raubreywhite/longitudinal_analysis/edit/master/01-reference.Rmd",
"text": "Edit"
},
"download": ["longitudinal-analysis.pdf"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"search": true
});
});
</script>

</body>

</html>
